Code is sourced from https://github.com/saket/swipe/tree/trunk